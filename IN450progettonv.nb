(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47461,       1121]
NotebookOptionsPosition[     44580,       1076]
NotebookOutlinePosition[     44919,       1091]
CellTagsIndexPosition[     44876,       1088]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DIFFERENTIAL COLLISIONS IN SHA-0", "Title",
 CellChangeTimes->{{3.785739073119232*^9, 
  3.785739078046434*^9}},ExpressionUUID->"7b68032b-e16c-406d-afa3-\
069fab79fa24"],

Cell["SHA-0", "Subtitle",
 CellChangeTimes->{{3.785739143332656*^9, 
  3.7857391447770443`*^9}},ExpressionUUID->"26585a10-1e02-42ab-a15e-\
c22d0fd812ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Esegue", " ", "il", " ", "padding", " ", "del", " ", "messaggio", " ", 
    RowBox[{"(", 
     RowBox[{"restituisce", " ", "un", " ", "intero"}], ")"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PaddingSHA0", "[", "msg_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", ",", "nzeros", ",", "padmsg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"len", "=", 
        RowBox[{"IntegerLength", "[", 
         RowBox[{"msg", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nzeros", "=", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"447", "-", "len"}], ",", "512"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"padmsg", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"msg", "*", "2"}], "+", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"2", "^", "nzeros"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"2", "^", "64"}], " ", ")"}]}], "+", " ", "len"}]}]}], " ",
       "\[IndentingNewLine]", ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.785740455442395*^9, 3.78574046805165*^9}, {
   3.788160061233761*^9, 3.788160063085183*^9}, {3.788246134272665*^9, 
   3.788246135199389*^9}, {3.7882469641427507`*^9, 3.788246987570183*^9}, {
   3.788247065214292*^9, 3.788247079918146*^9}, {3.788247136784883*^9, 
   3.78824717326624*^9}, {3.7882474221955223`*^9, 3.788247452769692*^9}, {
   3.7882476849015417`*^9, 3.7882477369686813`*^9}, 3.788248460340115*^9, {
   3.788248693280265*^9, 3.788248708336005*^9}, {3.788250089558477*^9, 
   3.7882500931736803`*^9}, {3.788596382312879*^9, 3.788596394859283*^9}, {
   3.788596468324955*^9, 3.788596502662814*^9}, {3.788597277050522*^9, 
   3.788597279875375*^9}, {3.788597346704982*^9, 3.788597355071121*^9}, 
   3.788688315075367*^9, {3.788866479609685*^9, 3.78886649600568*^9}, 
   3.7888671271577272`*^9, {3.788868902137463*^9, 3.7888689022387047`*^9}, {
   3.78887070839507*^9, 3.788870709412072*^9}, 3.788874067109606*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"3f9badc5-81d9-42f4-b21f-f971a93f84ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Ridefinisce", " ", "una", " ", "funzione", " ", "di", " ", "divisione", 
    " ", "con", " ", "un", " ", "solo", " ", "input"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"QuoRemUn", "[", "a_", "]"}], ":=", 
   RowBox[{"QuotientRemainder", "[", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"2", "^", "32"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.788265730765576*^9, {3.788590895575*^9, 3.788590955607935*^9}, {
   3.788591661793233*^9, 3.7885916623708277`*^9}, {3.7885917955442047`*^9, 
   3.788591795693575*^9}, {3.788592333527554*^9, 3.7885923532980967`*^9}, 
   3.788595728986313*^9, {3.788874081902749*^9, 3.788874096280259*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"1685199c-a5f4-4a01-b6eb-369727f6c9a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Funzione", " ", "per", " ", "portare", " ", "il", " ", "padmsg", " ", 
    "da", " ", "intero", " ", "a", " ", "lista", " ", "di", " ", "blocchi"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Form", "[", "init_", "]"}], ":=", 
   RowBox[{"NestWhileList", "[", 
    RowBox[{"QuoRemUn", ",", "init", ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "&"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.78859097991402*^9, 3.788591078839407*^9}, {
   3.7885911104859257`*^9, 3.788591136586535*^9}, {3.788591335868909*^9, 
   3.7885913458069572`*^9}, {3.788591387641529*^9, 3.7885913952782183`*^9}, {
   3.7885914383754063`*^9, 3.7885914414685097`*^9}, {3.7885918340347347`*^9, 
   3.788591856678515*^9}, {3.788592084471877*^9, 3.788592084669128*^9}, {
   3.7885929115987883`*^9, 3.788592913999668*^9}, {3.788593889598838*^9, 
   3.788593894526394*^9}, {3.788595739502265*^9, 3.788595750763158*^9}, {
   3.788597768058346*^9, 3.788597775589963*^9}, {3.7885979908678007`*^9, 
   3.788598017478182*^9}, 3.788866470126637*^9, {3.78886651369776*^9, 
   3.788866518504799*^9}, {3.788866674751328*^9, 3.788866688757813*^9}, 
   3.788870721153562*^9, {3.7888710502624207`*^9, 3.788871050768257*^9}, {
   3.788874074781785*^9, 3.788874117690277*^9}, 3.788874743943625*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"46506610-21cc-4972-99d9-0427e4e99ee9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Restituisce", " ", "la", " ", "costante", " ", "K", 
    RowBox[{"(", "i", ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cost", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FromDigits", "[", 
         RowBox[{"#", ",", "16"}], "]"}], "&"}], ",", 
       RowBox[{"{", " ", 
        RowBox[{
        "\"\<5A827999\>\"", ",", "\"\<6ED9EBA1\>\"", ",", "\"\<8F1BBCDC\>\"", 
         ",", "\"\<CA62C1D6\>\""}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Costki", "[", "i_", "]"}], ":=", 
    RowBox[{"cost", "[", 
     RowBox[{"[", 
      RowBox[{"Ceiling", "[", 
       RowBox[{"i", "/", "20"}], "]"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.77848366807176*^9, 3.778483668424336*^9}, {
   3.77848371710813*^9, 3.7784837187676487`*^9}, 3.7784837932153893`*^9, {
   3.778561003986869*^9, 3.778561094084797*^9}, {3.7785612023756943`*^9, 
   3.778561227523403*^9}, {3.778561261242289*^9, 3.7785614990287952`*^9}, {
   3.778561586136216*^9, 3.778561614550582*^9}, {3.7785616927950563`*^9, 
   3.778561766106264*^9}, {3.778561842114867*^9, 3.7785618669626627`*^9}, {
   3.77856203649977*^9, 3.77856211060942*^9}, {3.77856248283433*^9, 
   3.778562488232409*^9}, 3.778562920121714*^9, {3.778563143977297*^9, 
   3.778563192966885*^9}, 3.778563424187949*^9, {3.7785688867072678`*^9, 
   3.778568912959798*^9}, {3.779533357025597*^9, 3.779533432057609*^9}, {
   3.779533587170401*^9, 3.7795336390646973`*^9}, {3.782195914650105*^9, 
   3.7821959283794394`*^9}, {3.785592178034902*^9, 3.78559223276891*^9}, {
   3.785594443383894*^9, 3.78559444634628*^9}, {3.7855959111403*^9, 
   3.785595921795971*^9}, 3.785739132523239*^9, {3.785740112255966*^9, 
   3.785740124138867*^9}, {3.7858371079102497`*^9, 3.7858371861626987`*^9}, {
   3.7858372477160683`*^9, 3.785837302781315*^9}, {3.785837387833158*^9, 
   3.785837627309663*^9}, {3.7858377036314363`*^9, 3.785837720279703*^9}, {
   3.786600530542869*^9, 3.786600553679117*^9}, {3.786600607771121*^9, 
   3.7866006446479053`*^9}, {3.7866006835484056`*^9, 3.786600720895154*^9}, {
   3.788164514461853*^9, 3.788164540666024*^9}, {3.788688349311627*^9, 
   3.788688356184708*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"098e1fee-9f6f-4e6a-8910-59fd905ec5d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Restituisce", " ", "la", " ", "funzione", " ", "f", 
    RowBox[{"(", "i", ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"funcfi", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"BitOr", "[", 
        RowBox[{
         RowBox[{"BitAnd", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"BitAnd", "[", 
          RowBox[{"x", ",", "z"}], "]"}]}], "]"}], ",", 
       RowBox[{"BitXor", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"BitOr", "[", 
        RowBox[{
         RowBox[{"BitAnd", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", 
         RowBox[{"BitAnd", "[", 
          RowBox[{"x", ",", "z"}], "]"}], ",", 
         RowBox[{"BitAnd", "[", 
          RowBox[{"y", ",", "z"}], "]"}]}], "]"}], ",", 
       RowBox[{"BitXor", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Funcfi", "[", 
     RowBox[{"i_", ",", "t_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"funcfi", "[", 
       RowBox[{"[", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"i", "/", "20"}], "]"}], "]"}], "]"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "\[Rule]", 
        RowBox[{"t", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"y", "\[Rule]", 
        RowBox[{"t", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"z", "\[Rule]", 
        RowBox[{"t", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.77848366807176*^9, 3.778483668424336*^9}, {
   3.77848371710813*^9, 3.7784837187676487`*^9}, 3.7784837932153893`*^9, {
   3.778561003986869*^9, 3.778561094084797*^9}, {3.7785612023756943`*^9, 
   3.778561227523403*^9}, {3.778561261242289*^9, 3.7785614990287952`*^9}, {
   3.778561586136216*^9, 3.778561614550582*^9}, {3.7785616927950563`*^9, 
   3.778561766106264*^9}, {3.778561842114867*^9, 3.7785618669626627`*^9}, {
   3.77856203649977*^9, 3.77856211060942*^9}, {3.77856248283433*^9, 
   3.778562488232409*^9}, 3.778562920121714*^9, {3.778563143977297*^9, 
   3.778563192966885*^9}, 3.778563424187949*^9, {3.7785688867072678`*^9, 
   3.778568912959798*^9}, {3.779533357025597*^9, 3.779533432057609*^9}, {
   3.779533587170401*^9, 3.7795336390646973`*^9}, {3.782195914650105*^9, 
   3.7821959283794394`*^9}, {3.785592178034902*^9, 3.78559223276891*^9}, {
   3.785594443383894*^9, 3.78559444634628*^9}, {3.7855959111403*^9, 
   3.785595921795971*^9}, 3.785739132523239*^9, {3.785740112255966*^9, 
   3.785740124138867*^9}, {3.7858371079102497`*^9, 3.7858371861626987`*^9}, {
   3.7858372477160683`*^9, 3.785837302781315*^9}, {3.785837387833158*^9, 
   3.785837627309663*^9}, {3.7858377036314363`*^9, 3.785837720279703*^9}, {
   3.786600530542869*^9, 3.786600553679117*^9}, {3.7866009959578753`*^9, 
   3.786601008488022*^9}, {3.786601060503038*^9, 3.786601070310837*^9}, {
   3.788164526825903*^9, 3.78816452944771*^9}, {3.7886883769802732`*^9, 
   3.788688385537644*^9}, 3.788688571411724*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"c62f5f5f-5045-4f4d-8725-3c30b24e6ba6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Expansion", ":", " ", 
    RowBox[{"prende", " ", "16", " ", "numeri", " ", 
     RowBox[{"(", 
      RowBox[{
      "ogni", " ", "numero", " ", "sarebbe", " ", "una", " ", "parola", " ", 
       "da", " ", "32", " ", "bit"}], ")"}], " ", "in", " ", "input", " ", 
     "e", " ", "ne", " ", "d\[AGrave]", " ", "80", " ", "in", " ", 
     "output"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"taps", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3"}], ",", 
       RowBox[{"-", "8"}], ",", 
       RowBox[{"-", "14"}], ",", 
       RowBox[{"-", "16"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Step", "[", "blocco_", "]"}], ":=", 
    RowBox[{"Append", "[", 
     RowBox[{"blocco", ",", 
      RowBox[{"BitXor", "@@", 
       RowBox[{"blocco", "[", 
        RowBox[{"[", "taps", "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Expansion", "[", "blocco_", "]"}], ":=", 
    RowBox[{"Nest", "[", 
     RowBox[{"Step", ",", "blocco", ",", 
      RowBox[{"80", "-", "16"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.785837899478191*^9, 3.7858380253686733`*^9}, {
   3.785838063092688*^9, 3.785838099127746*^9}, {3.7858381608452787`*^9, 
   3.785838247017552*^9}, {3.786601128308609*^9, 3.7866011339181547`*^9}, {
   3.788159824679268*^9, 3.788159834243643*^9}, {3.7885917644470243`*^9, 
   3.78859177407189*^9}, {3.7886883903684683`*^9, 3.78868840540902*^9}, 
   3.788688574015812*^9, {3.7888590338982677`*^9, 3.788859048006703*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"1361bf44-91de-43f3-97a9-4a63bde7a023"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Ruota", " ", "interi", " ", 
    RowBox[{"(", 
     RowBox[{"parole", " ", "di", " ", "32", " ", "bit"}], ")"}], " ", "di", 
    " ", "num", " ", "bits", " ", "a", " ", "sinistra"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"IntRotateLeft", "[", 
    RowBox[{"x_", ",", "num_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "^", "num"}], ")"}], "*", " ", 
     RowBox[{"Mod", "[", 
      RowBox[{"x", ",", 
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"32", "-", "num"}], ")"}]}]}], "]"}]}], "+", 
    RowBox[{"Floor", "[", 
     RowBox[{"x", "/", 
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{"32", "-", "num"}], ")"}]}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.785839288543832*^9, 3.785839308096397*^9}, {
   3.7858400365153522`*^9, 3.785840049204411*^9}, {3.7858400966236057`*^9, 
   3.785840198424389*^9}, {3.785840739248631*^9, 3.785840798794044*^9}, {
   3.785840907032975*^9, 3.7858410833510942`*^9}, {3.785841294032036*^9, 
   3.78584131767947*^9}, 3.78661740532933*^9, {3.7866177670884666`*^9, 
   3.7866178952111692`*^9}, {3.788155486411998*^9, 3.788155489235217*^9}, {
   3.7881564630484877`*^9, 3.7881564644314013`*^9}, 3.788157080123683*^9, {
   3.788158701889975*^9, 3.7881587030804377`*^9}, {3.788688422197041*^9, 
   3.7886884366704683`*^9}, {3.788856541432838*^9, 3.7888565435478277`*^9}, {
   3.788857784486453*^9, 3.788857828306446*^9}, {3.788874124076049*^9, 
   3.788874140706443*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"677c9181-bd1d-4463-859e-c31047be969f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"FStep", " ", "fa", " ", 
    RowBox[{"l", "'"}], "aggiornamento", " ", "del", " ", "registro", " ", 
    "A"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"FStep", "[", 
     RowBox[{"qqb_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Expansion", "[", 
         RowBox[{"qqb", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "+", 
       RowBox[{"IntRotateLeft", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"qqb", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "5"}], "]"}], "+", 
       RowBox[{"Funcfi", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"qqb", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "+", 
       RowBox[{"Costki", "[", "i", "]"}]}], ",", 
      RowBox[{"2", "^", "32"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.788157639713852*^9, 3.788157640799123*^9}, {
   3.78815767590436*^9, 3.788157692727385*^9}, {3.788158261011429*^9, 
   3.788158266374364*^9}, {3.788158408417841*^9, 3.788158425956789*^9}, {
   3.788158609693853*^9, 3.788158614451399*^9}, {3.788159839354743*^9, 
   3.7881598507992687`*^9}, 3.7886884572820063`*^9, {3.788857838068636*^9, 
   3.788857838674612*^9}, 3.788870088140547*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"9ffbb1dc-1587-40a5-bca4-d68415e9f3a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "FF", " ", "fa", " ", "un", " ", "aggiornamento", " ", "della", " ", 
    "compression", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FF", "[", 
    RowBox[{"qqb_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xx", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"FStep", "[", 
             RowBox[{"qqb", ",", "i"}], "]"}]}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"IntRotateLeft", "[", 
         RowBox[{
          RowBox[{"xx", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "30"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"xx", ",", 
         RowBox[{"qqb", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.785839288543832*^9, 3.785839308096397*^9}, {
   3.7858400365153522`*^9, 3.785840049204411*^9}, {3.7858400966236057`*^9, 
   3.785840198424389*^9}, {3.785840739248631*^9, 3.785840798794044*^9}, {
   3.785840907032975*^9, 3.7858410833510942`*^9}, {3.785841294032036*^9, 
   3.78584131767947*^9}, 3.78661740532933*^9, {3.78815549787389*^9, 
   3.788155498144676*^9}, {3.7881557765385313`*^9, 3.78815577748317*^9}, {
   3.7881565206553717`*^9, 3.7881565215605593`*^9}, {3.788157052955885*^9, 
   3.788157061517784*^9}, {3.7881582909644823`*^9, 3.7881583028549356`*^9}, {
   3.788158444127758*^9, 3.7881584568850813`*^9}, 3.788158493720887*^9, {
   3.788159695406516*^9, 3.788159702955392*^9}, {3.788688464742668*^9, 
   3.788688465338352*^9}, {3.788870097933432*^9, 3.7888700991459217`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"0d72a7f1-389f-4739-85a5-928a82cbc421"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "CompressionF", " ", "\[EGrave]", " ", "la", " ", "compression", " ", 
     "function", " ", "e", " ", "fa", " ", "il", " ", "ciclo", " ", "di", " ",
      "80", " ", 
     RowBox[{"aggiornamenti", ".", " ", "qqb"}]}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"quintupla", " ", "dei", " ", "registri"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", " ", "numeri", " ", "del", " ", "blocco"}], "}"}]}], 
     "}"}]}], "*)"}], 
  RowBox[{
   RowBox[{"CompressionF", "[", "qqb_", "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{"FF", ",", "qqb", ",", 
     RowBox[{"Range", "[", "80", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.785841095063829*^9, 3.785841101869727*^9}, {
   3.785841162779704*^9, 3.7858411774019337`*^9}, {3.788159540423216*^9, 
   3.788159562200369*^9}, 3.788159603239517*^9, {3.7881596633308783`*^9, 
   3.788159663649292*^9}, 3.7881636387206573`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"4f688d5d-989d-4ec9-bee7-4fd1fdc67093"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Inizializzazione", " ", "registri"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"reg", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FromDigits", "[", 
        RowBox[{"#", ",", "16"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<67452301\>\"", ",", "\"\<EFCDAB89\>\"", ",", "\"\<98BADCFE\>\"", 
        ",", "\"\<10325476\>\"", ",", "\"\<C3D2E1F0\>\""}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{3.788871140255951*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"fad529d2-f939-4279-80b8-9bb5e0ea5512"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "Fa", " ", "un", " ", "aggiornamento", " ", "dello", " ", "SHA"}], "-", 
      "0"}], ":", " ", "regpad"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"registri", " ", 
        RowBox[{"(", "5", ")"}]}], "}"}], ",", 
      RowBox[{"{", "padmsg", "}"}]}], "}"}]}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{"da", " ", 
    RowBox[{"migliorare", ":", " ", 
     RowBox[{
     "posso", " ", "evitare", " ", "di", " ", "portarmi", " ", "dietro", " ", 
      "tutto", " ", "il", " ", 
      RowBox[{"padmsg", "?"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Agg", "[", 
    RowBox[{"reg_", ",", "block_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "regg", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"regg", "=", "reg"}], ";", "\[IndentingNewLine]", 
       RowBox[{"regg", "=", 
        RowBox[{
         RowBox[{"CompressionF", "[", 
          RowBox[{"{", 
           RowBox[{"regg", ",", "block"}], "}"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"reg", "+", "regg"}]}], "\[IndentingNewLine]", ")"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.788163739558323*^9, 3.788163749166366*^9}, {
   3.788165625596181*^9, 3.788165723660795*^9}, {3.788172177880186*^9, 
   3.788172178950232*^9}, {3.788172240908402*^9, 3.788172244161694*^9}, {
   3.7881723994296017`*^9, 3.788172411538472*^9}, 3.788172960427331*^9, {
   3.78817376917743*^9, 3.788173855693334*^9}, {3.78817395236843*^9, 
   3.788173978975218*^9}, {3.788174009957996*^9, 3.788174060481184*^9}, {
   3.788174290305512*^9, 3.788174310876165*^9}, {3.788241327278857*^9, 
   3.788241404931726*^9}, {3.788243296348464*^9, 3.78824330370877*^9}, {
   3.788243870489334*^9, 3.788243878187283*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"cc44b01c-6dd2-4019-a3dc-7d2fdf2ff1dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Calc", " ", "\[EGrave]", " ", "la", " ", "funzione", " ", 
    RowBox[{"principale", ":", " ", 
     RowBox[{
     "fa", " ", "aggiornamenti", " ", "per", " ", "ogni", " ", "blocco", " ", 
      "di", " ", "padmsg"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Calc", "[", "padmsg_", "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Fold", "[", 
         RowBox[{"Agg", ",", "reg", ",", 
          RowBox[{"padmsg", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "padmsg", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.788172834575572*^9, 3.788172848687961*^9}, {
  3.788174324977685*^9, 3.788174327593713*^9}, {3.788174482872199*^9, 
  3.788174495547171*^9}, {3.788174655598371*^9, 3.788174683471827*^9}, {
  3.7881747466113253`*^9, 3.7881748064775743`*^9}, {3.788174857084105*^9, 
  3.7881748603558493`*^9}, {3.788174907275807*^9, 3.788174979322729*^9}, {
  3.788242782605825*^9, 3.788242857932117*^9}, {3.7882440359967337`*^9, 
  3.788244061359866*^9}, {3.788866946100646*^9, 3.788866960639176*^9}, {
  3.788867037693009*^9, 3.788867055737424*^9}, {3.7888671832745867`*^9, 
  3.788867214782041*^9}, {3.788868614961135*^9, 3.788868617851289*^9}, {
  3.788868726404044*^9, 3.788868730283526*^9}, {3.788869703743973*^9, 
  3.7888697586153*^9}, {3.788869807813752*^9, 3.7888698080887527`*^9}, {
  3.788874017416717*^9, 3.788874020901432*^9}, {3.788875265698641*^9, 
  3.788875266686152*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"88e8dfc7-5c94-428b-bb4d-a261597342aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SHA0", "[", "msg_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reg", ",", "init", ",", "padmsgform"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reg", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FromDigits", "[", 
           RowBox[{"#", ",", "16"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<67452301\>\"", ",", "\"\<EFCDAB89\>\"", ",", 
           "\"\<98BADCFE\>\"", ",", "\"\<10325476\>\"", ",", 
           "\"\<C3D2E1F0\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PaddingSHA0", "[", "msg", "]"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"padmsgform", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Form", "[", "init", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", "16"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Calc", "[", "padmsgform", "]"}]}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.788873900784504*^9, 3.788874001297336*^9}, {
  3.7888752688283463`*^9, 3.788875275162478*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"bb1e6fbb-5f69-4d62-a324-1e4ea20d117d"],

Cell[CellGroupData[{

Cell["ATTACCO", "Subtitle",
 CellChangeTimes->{{3.785739152758954*^9, 3.785739166841257*^9}, {
  3.785741142182755*^9, 
  3.78574114326687*^9}},ExpressionUUID->"b2c82001-ee5e-4243-b29d-\
c914e8c9c807"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DIFFERENTIAL", " ", "MASK", " ", "CON", " ", "c"}], "=", "68"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalEGrave]", " ", 
     RowBox[{"l", "'"}], "espansione", " ", 
     RowBox[{"dell", "'"}], 
     RowBox[{"attacco", ":", " ", 
      RowBox[{
      "prima", " ", "di", " ", "espandere", " ", "il", " ", "blocco"}]}]}], 
    ",", " ", 
    RowBox[{
    "vi", " ", "somma", " ", "la", " ", "mitable", " ", "creando", " ", 
     "delle", " ", "perturbazioni"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ExpansionColl", "[", "blocco_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vettm0", ",", "m0", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
       "m5", ",", "mtot", ",", "mi", ",", "expcoll"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vettm0", "=", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", 
          ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", 
          "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", 
          ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
          "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", 
          ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          "0", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1", 
          ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m0", "=", 
        RowBox[{"vettm0", "*", 
         RowBox[{"2", "^", "31"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "5"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m2", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"m0", ",", 
            RowBox[{"-", "2"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m3", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "30"}], "]"}], ",", 
            RowBox[{"-", "3"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m4", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "30"}], "]"}], ",", 
            RowBox[{"-", "4"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m5", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "30"}], "]"}], ",", 
            RowBox[{"-", "5"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mtot", "=", 
        RowBox[{"BitXor", "[", 
         RowBox[{
         "m0", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mi", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"mtot", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"expcoll", "=", 
        RowBox[{"BitXor", "[", 
         RowBox[{"mi", ",", "blocco"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Expansion", "[", "expcoll", "]"}]}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.785735168854719*^9, {3.7857356565983267`*^9, 3.7857357364167643`*^9}, {
   3.785739217282496*^9, 3.785739250195804*^9}, {3.7857402272012987`*^9, 
   3.78574032398141*^9}, {3.785819047921009*^9, 3.785819058713414*^9}, {
   3.785819117508209*^9, 3.785819118665339*^9}, 3.785819172309024*^9, {
   3.7886893572417927`*^9, 3.788689359195751*^9}, {3.7888560935827293`*^9, 
   3.788856103953472*^9}, {3.7888563335050077`*^9, 3.7888564265959044`*^9}, {
   3.7888578651582327`*^9, 3.7888579033479977`*^9}, {3.788857935070271*^9, 
   3.788857937895105*^9}, {3.788858026736972*^9, 3.788858051348196*^9}, {
   3.788858097717392*^9, 3.788858145303549*^9}, {3.7888582259397*^9, 
   3.7888582428691998`*^9}, {3.7888582801163597`*^9, 3.788858405682637*^9}, {
   3.788858437824564*^9, 3.7888585485664387`*^9}, {3.7888587998223133`*^9, 
   3.7888588351635857`*^9}, {3.788858922070786*^9, 3.788858985725884*^9}, {
   3.78885906322224*^9, 3.788859064060175*^9}, {3.788870163204051*^9, 
   3.7888701639613247`*^9}, {3.7888708768696737`*^9, 3.788870923483964*^9}, 
   3.7888734389884443`*^9, {3.788874799104702*^9, 3.788874915725461*^9}, 
   3.788874970293735*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"49cb6c16-d949-4326-8899-fb1f090d1064"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Stesse", " ", "funzioni", " ", "dello", " ", "SHA"}], "-", 
     "0"}], ",", " ", 
    RowBox[{"ma", " ", "sfruttano", " ", 
     RowBox[{"l", "'"}], "espansione", " ", 
     RowBox[{"dell", "'"}], "attacco"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"FStepColl", "[", 
     RowBox[{"qqb_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ExpansionColl", "[", 
         RowBox[{"qqb", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "+", 
       RowBox[{"IntRotateLeft", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"qqb", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "5"}], "]"}], "+", 
       RowBox[{"Funcfi", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"qqb", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], "]"}], "+", 
       RowBox[{
        RowBox[{"qqb", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "+", 
       RowBox[{"Costki", "[", "i", "]"}]}], ",", 
      RowBox[{"2", "^", "32"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.788870938759882*^9, 3.7888709531465893`*^9}, {
   3.788870999139311*^9, 3.7888710031773033`*^9}, {3.7888710399439793`*^9, 
   3.788871040378457*^9}, 3.788874964671459*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"8b3f0cfc-28e1-43a0-beea-ce2ff73ddd9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FFColl", "[", 
   RowBox[{"qqb_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xx", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"qqb", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"FStepColl", "[", 
            RowBox[{"qqb", ",", "i"}], "]"}]}], "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xx", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"IntRotateLeft", "[", 
        RowBox[{
         RowBox[{"xx", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "30"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"xx", ",", 
        RowBox[{"qqb", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785607565507432*^9, 3.785607586308567*^9}, {
   3.7856077419877243`*^9, 3.785607743870388*^9}, 3.785608280231073*^9, {
   3.7856086130312023`*^9, 3.785608650681149*^9}, 3.785609910633874*^9, {
   3.785679457430168*^9, 3.785679457924357*^9}, {3.7856795254444017`*^9, 
   3.785679525839973*^9}, {3.785739264827577*^9, 3.785739265765876*^9}, 
   3.785739388400182*^9, {3.785740376782949*^9, 3.7857403876936417`*^9}, {
   3.785740440114018*^9, 3.7857404409828176`*^9}, {3.785819231404234*^9, 
   3.7858192668728237`*^9}, {3.788871067542511*^9, 3.7888710820931797`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"06427401-13a9-4e70-8137-02d7931ea1f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompressionFColl", "[", "qqb_", "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{"FFColl", ",", "qqb", ",", 
    RowBox[{"Range", "[", "80", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.788871098046926*^9, 3.788871102454729*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"32224aa8-94d4-4f46-a98a-23320013e4d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AggColl", "[", 
   RowBox[{"reg_", ",", "block_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "regg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"regg", "=", "reg"}], ";", "\[IndentingNewLine]", 
      RowBox[{"regg", "=", 
       RowBox[{
        RowBox[{"CompressionFColl", "[", 
         RowBox[{"{", 
          RowBox[{"regg", ",", "block"}], "}"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"reg", "+", "regg"}]}], "\[IndentingNewLine]", ")"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.788871121119316*^9, 3.7888711215344973`*^9}, {
  3.788871163112067*^9, 3.7888711652832193`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"65a8ad01-af10-4e42-8095-ed55e15a3962"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CalcColl", "[", "padmsg_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Fold", "[", 
        RowBox[{"AggColl", ",", "reg", ",", 
         RowBox[{"padmsg", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "padmsg", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.788871173419088*^9, 3.7888711791814957`*^9}, {
  3.788874045500668*^9, 3.788874048022985*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"40241848-9f52-43be-87e5-4b24f23a6221"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SHA0Coll", "[", "msg_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"reg", ",", "init", ",", "padmsgform"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"reg", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FromDigits", "[", 
           RowBox[{"#", ",", "16"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<67452301\>\"", ",", "\"\<EFCDAB89\>\"", ",", 
           "\"\<98BADCFE\>\"", ",", "\"\<10325476\>\"", ",", 
           "\"\<C3D2E1F0\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"init", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PaddingSHA0", "[", "msg", "]"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"padmsgform", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Form", "[", "init", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", "16"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"CalcColl", "[", "padmsgform", "]"}]}], "\[IndentingNewLine]", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.788875128136832*^9, 3.7888751398952312`*^9}, {
  3.788875303847836*^9, 3.7888753272091703`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"dba60236-5e5c-46b6-b031-854fc7b6a9de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DIFFERENTIAL", " ", "MASK", " ", "CON", " ", "c"}], "=", "69"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalEGrave]", " ", 
     RowBox[{"l", "'"}], "espansione", " ", 
     RowBox[{"dell", "'"}], 
     RowBox[{"attacco", ":", " ", 
      RowBox[{
      "prima", " ", "di", " ", "espandere", " ", "il", " ", "blocco"}]}]}], 
    ",", " ", 
    RowBox[{
    "vi", " ", "somma", " ", "la", " ", "mitable", " ", "creando", " ", 
     "delle", " ", "perturbazioni"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ExpansionColl2", "[", "blocco_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vettm0", ",", "m0", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", 
       "m5", ",", "mtot", ",", "mi", ",", "expcoll"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vettm0", "=", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
          ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
          "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", 
          ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", 
          "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
          "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
          ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
          "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1", ",", "0", 
          ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", 
          ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m0", "=", 
        RowBox[{"vettm0", "*", 
         RowBox[{"2", "^", "31"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "5"}], "]"}], ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m2", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"m0", ",", 
            RowBox[{"-", "2"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m3", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "30"}], "]"}], ",", 
            RowBox[{"-", "3"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m4", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "30"}], "]"}], ",", 
            RowBox[{"-", "4"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m5", "=", 
        RowBox[{"PadLeft", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"IntRotateLeft", "[", 
             RowBox[{"m0", ",", "30"}], "]"}], ",", 
            RowBox[{"-", "5"}]}], "]"}], ",", "85"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mtot", "=", 
        RowBox[{"BitXor", "[", 
         RowBox[{
         "m0", ",", "m1", ",", "m2", ",", "m3", ",", "m4", ",", "m5"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mi", "=", 
        RowBox[{"Take", "[", 
         RowBox[{"mtot", ",", "16"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"expcoll", "=", 
        RowBox[{"BitXor", "[", 
         RowBox[{"mi", ",", "blocco"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Expansion", "[", "expcoll", "]"}]}], "\[IndentingNewLine]", 
      ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.785697146510295*^9, 3.785697154518968*^9}, {
  3.785697210451797*^9, 3.785697294389332*^9}, {3.7857359893236027`*^9, 
  3.785735993704568*^9}, {3.785739269961608*^9, 3.785739280871409*^9}, {
  3.785740341994485*^9, 3.7857403449994583`*^9}, {3.788875015840577*^9, 
  3.788875066218688*^9}},ExpressionUUID->"d4df23b0-dd37-4007-b9f2-\
76abfa8fd95d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lancio", "Subtitle",
 CellChangeTimes->{{3.7857394011868753`*^9, 
  3.785739401809877*^9}},ExpressionUUID->"bf4807b2-3aa0-43e1-a7b7-\
ff802fe80d24"],

Cell[BoxData[{
 RowBox[{"msg", "=", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{"2", "^", "64"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SHA0", "[", "msg", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SHA0Coll", "[", "msg", "]"}]}], "Input",
 CellChangeTimes->{{3.785740580393406*^9, 3.785740685720339*^9}, {
  3.78574093415413*^9, 3.785740934649239*^9}, {3.785819127097705*^9, 
  3.785819129823203*^9}, {3.788875082469933*^9, 3.788875106482692*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"37779864-36d9-4b57-bd62-2e72d6beb14a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1449, 907},
WindowMargins->{{60, Automatic}, {-15, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 175, 3, 98, "Title",ExpressionUUID->"7b68032b-e16c-406d-afa3-069fab79fa24"],
Cell[758, 27, 153, 3, 53, "Subtitle",ExpressionUUID->"26585a10-1e02-42ab-a15e-c22d0fd812ac"],
Cell[914, 32, 2285, 49, 157, "Input",ExpressionUUID->"3f9badc5-81d9-42f4-b21f-f971a93f84ea"],
Cell[3202, 83, 842, 19, 52, "Input",ExpressionUUID->"1685199c-a5f4-4a01-b6eb-369727f6c9a0"],
Cell[4047, 104, 1478, 27, 52, "Input",ExpressionUUID->"46506610-21cc-4972-99d9-0427e4e99ee9"],
Cell[5528, 133, 2356, 45, 73, "Input",ExpressionUUID->"098e1fee-9f6f-4e6a-8910-59fd905ec5d5"],
Cell[7887, 180, 3236, 70, 73, "Input",ExpressionUUID->"c62f5f5f-5045-4f4d-8725-3c30b24e6ba6"],
Cell[11126, 252, 1661, 38, 94, "Input",ExpressionUUID->"1361bf44-91de-43f3-97a9-4a63bde7a023"],
Cell[12790, 292, 1631, 36, 52, "Input",ExpressionUUID->"677c9181-bd1d-4463-859e-c31047be969f"],
Cell[14424, 330, 2050, 52, 73, "Input",ExpressionUUID->"9ffbb1dc-1587-40a5-bca4-d68415e9f3a6"],
Cell[16477, 384, 2175, 48, 157, "Input",ExpressionUUID->"0d72a7f1-389f-4739-85a5-928a82cbc421"],
Cell[18655, 434, 1070, 25, 52, "Input",ExpressionUUID->"4f688d5d-989d-4ec9-bee7-4fd1fdc67093"],
Cell[19728, 461, 639, 18, 52, "Input",ExpressionUUID->"fad529d2-f939-4279-80b8-9bb5e0ea5512"],
Cell[20370, 481, 2035, 48, 157, "Input",ExpressionUUID->"cc44b01c-6dd2-4019-a3dc-7d2fdf2ff1dd"],
Cell[22408, 531, 1836, 38, 52, "Input",ExpressionUUID->"88e8dfc7-5c94-428b-bb4d-a261597342aa"],
Cell[24247, 571, 1659, 43, 157, "Input",ExpressionUUID->"bb1e6fbb-5f69-4d62-a324-1e4ea20d117d"],
Cell[CellGroupData[{
Cell[25931, 618, 201, 4, 53, "Subtitle",ExpressionUUID->"b2c82001-ee5e-4243-b29d-c914e8c9c807"],
Cell[26135, 624, 5615, 122, 388, "Input",ExpressionUUID->"49cb6c16-d949-4326-8899-fb1f090d1064"],
Cell[31753, 748, 1971, 53, 73, "Input",ExpressionUUID->"8b3f0cfc-28e1-43a0-beea-ce2ff73ddd9f"],
Cell[33727, 803, 1746, 40, 136, "Input",ExpressionUUID->"06427401-13a9-4e70-8137-02d7931ea1f8"],
Cell[35476, 845, 348, 7, 30, "Input",ExpressionUUID->"32224aa8-94d4-4f46-a98a-23320013e4d8"],
Cell[35827, 854, 852, 20, 136, "Input",ExpressionUUID->"65a8ad01-af10-4e42-8095-ed55e15a3962"],
Cell[36682, 876, 755, 20, 30, "Input",ExpressionUUID->"40241848-9f52-43be-87e5-4b24f23a6221"],
Cell[37440, 898, 1669, 43, 157, "Input",ExpressionUUID->"dba60236-5e5c-46b6-b031-854fc7b6a9de"],
Cell[39112, 943, 4716, 110, 367, "Input",ExpressionUUID->"d4df23b0-dd37-4007-b9f2-76abfa8fd95d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43865, 1058, 154, 3, 53, "Subtitle",ExpressionUUID->"bf4807b2-3aa0-43e1-a7b7-ff802fe80d24"],
Cell[44022, 1063, 530, 9, 73, "Input",ExpressionUUID->"37779864-36d9-4b57-bd62-2e72d6beb14a"]
}, Open  ]]
}, Open  ]]
}
]
*)

